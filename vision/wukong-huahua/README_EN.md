## Contents

[查看中文](./README.md)

- [Wukong-Huahua](#wukong-huahua)
- [Environment requirements](#environment-requirements)
- [Quick Start](#quick-start)
    - [Prepare checkpoint](#prepare-checkpoint)
    - [Text to Image generation](#text-to-image-generation)
    - [Demos](#demos)


## Wukong-Huahua

Wukong-Huahua is a diffusion-based model that perfoms text-to-image task, which was developed by the *Huawei Noah's Ark Lab* in cooperation with the *Distributed & Parallel Software Lab* and *Ascend Product Develop Unit*. It was trained on [Wukong dataset](https://wukong-dataset.github.io/wukong-dataset/)  and implemented by Mindspore.

## Environment requirements

- Hardware
    - Ascend processor
- Framework
    - [Mindspore](https://www.mindspore.cn/ "Mindspore") >= 1.9
    - install remaining python packages according to [requirements.txt](./requirements.txt)
- Tutorialm
    - [Mindspore Tutorial](https://www.mindspore.cn/tutorials/zh-CN/master/index.html)
    - [Mindspore Python API](https://www.mindspore.cn/docs/zh-CN/master/index.html)

## Quick Start
### Prepare checkpoint
Download Wukong-Huahua pretrained checkpoint [wukong-huahua-ms.ckpt](https://download.mindspore.cn/toolkits/minddiffusion/wukong-huahua/wukong-huahua-ms.ckpt) and place it under wukong-huahua/models/ folder.


### Text to image generation
To generate images according to input text, run txt2img.py or simply infer.sh with default argumemts.
```shell
python txt2img.py --prompt [input text] --ckpt_path [ckpt_path] --H [image_height] --W [image_width] --outdir [image save folder] --n_samples [number of images to generate] --plms --skip_grid
```

```shell
bash infer.sh
```

Generating higher resolution requires more memory. For Ascend 910 card, we can generate 2 1024x768 images or 16 512 x 512 images at same time.

### Demos
Below are some of the images generated by our wukong-huahua model. 

```
城市夜景 赛博朋克 格雷格·鲁特科夫斯基
```
![城市夜景 赛博朋克 格雷格·鲁特科夫斯基](demo/城市夜景%20赛博朋克%20格雷格·鲁特科夫斯基.png)

```
莫奈 撑阳伞的女人 月亮 梦幻
```
![莫奈 撑阳伞的女人 月亮 梦幻](demo/莫奈%20撑阳伞的女人%20月亮%20梦幻.png)
```
海上日出时候的奔跑者
```
![海上日出时候的奔跑者](demo/海上日出时候的奔跑者.png)
```
诺亚方舟在世界末日起航 科幻插画
```
![诺亚方舟在世界末日起航 科幻插画](demo/诺亚方舟在世界末日起航%20科幻插画.png)
```
时空 黑洞 辐射
```
![时空 黑洞 辐射](demo/时空%20黑洞%20辐射.png)
```
乡村 田野 屏保
```
![乡村 田野 屏保](demo/乡村%20田野%20屏保.png)